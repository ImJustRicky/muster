# Muster — LLM Guide

> Universal deploy framework. Pure bash (3.2+), zero dependencies, modular TUI.

## Quick Reference

```bash
muster setup       # interactive setup wizard (creates deploy.json + hooks)
muster             # dashboard (live health + action menu)
muster deploy      # deploy all services
muster deploy api  # deploy one service
muster status      # health check all services
muster logs <svc>  # stream logs for a service
muster rollback <svc>  # rollback a service
muster cleanup     # clean stuck processes + old logs
muster uninstall   # remove muster from project
muster skill add <url>  # install a skill addon
muster skill list       # list installed skills
muster skill remove <n> # remove a skill
```

## Project Structure

```
muster/
├── bin/muster                     ← entry point (routes commands)
├── bin/muster-mcp                 ← MCP stdio transport (LLM tool interface)
├── lib/core/                      ← config, colors, logger, platform, utils
├── lib/tui/                       ← menu, checklist, spinner, progress, streambox, dashboard
├── lib/commands/                  ← setup, deploy, status, logs, rollback, cleanup, uninstall
├── lib/skills/manager.sh          ← skill lifecycle
├── templates/deploy.example.json  ← example config
└── docs/skills.md                 ← skill authoring guide
```

## Per-Project Structure (generated by setup)

```
your-project/
├── deploy.json        ← config: services, health checks, deploy order
└── .muster/
    ├── hooks/<svc>/   ← deploy.sh, health.sh, rollback.sh, logs.sh, cleanup.sh
    └── logs/          ← deploy logs (gitignored)
```

## Config (deploy.json)

Service keys map to hook directories. Health types: `http`, `tcp`, `command`, `null`. `deploy_order` controls sequencing. Credentials never stored in config.

## Bash 3.2 Rules

- No `local -a`, no namerefs, no fractional `read -t`
- Use `printf '%b'` not `echo -e` for ANSI
- Use `printf '%*s'` for padding (not `printf "%-Ns"` with ANSI)
- Use `#`/`-` for progress bars (not `█`/`░`)
- `tput cuu1` + `tput ed` for redraws (no `tput sc/rc`)
- SIGWINCH does not interrupt `read -rsn1` on macOS bash 3.2

## Editing Guidelines

- All TUI box widths: `W = TERM_COLS - 4`, max 50 (or 56 for banner), min 10
- Colors via variables from `lib/core/colors.sh` (never hardcode escapes)
- Array append: `arr[${#arr[@]}]=value` (not `arr+=()`)
- Test with `bash -n file.sh` for syntax validation
